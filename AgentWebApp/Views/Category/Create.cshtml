@model CategoryModel

@{
    ViewData["Title"] = "Create";
}

<div class="container-xxl flex-grow-1 container-p-y">
    <h4 class="fw-bold py-3 mb-4"><span class="text-muted fw-light">Category/</span> Create Category</h4>
    <div class="row">
        <div class="col-md-12">
            <form asp-action="Create" enctype="multipart/form-data">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                @* <div class="form-group">
                <label asp-for="Name" class="control-label"></label>
                <input asp-for="Name" class="form-control" />
                <span asp-validation-for="Name" class="text-danger"></span>
                </div>*@
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-body">
                            <div class="form-floating">
                                <input asp-for="ID" type="hidden" class="form-control" />
                                <input asp-for="Name"
                                       class="form-control" id="floatingInput"
                                       aria-describedby="floatingInput" />
                                <span asp-validation-for="Name" class="text-danger"></span>
                                <label asp-for="Name" for="floatingInput">Name</label>

                            </div>
                        </div>
                        <div class="card-body">
                            <div class="form-floating">
                                <input asp-for="Description"
                                       class="form-control"
                                       aria-describedby="floatingInput" />
                                <label asp-for="Description" for="floatingInput">Description</label>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="form-floating">
                                <input asp-for="FromDate" id="datetime-picker"
                                       class="form-control"
                                       aria-describedby="floatingInput" />
                                <label asp-for="FromDate" for="floatingInput">From Date</label>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="form-floating">
                                <input asp-for="ToDate" id="datetime-picker"
                                       class="form-control"
                                       aria-describedby="floatingInput" />
                                <label asp-for="ToDate" for="floatingInput">To Date</label>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="form-floating">
                                <input type="datetime" id="DateTime"
                                       class="form-control"
                                       aria-describedby="floatingInput" />
                                <label asp-for="ToDate" for="floatingInput">To Date</label>
                                <span id="errorMessage"></span>
                            </div>
                        </div>


                        <div class="card-body">
                            <div class="form-floating">
                                <input asp-for="File"
                                       class="form-control"
                                       aria-describedby="floatingInput" />
                                <label asp-for="File" for="floatingInput">File</label>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="form-floating">
                                <select id="mySelectnone" name="selectedOptions" style="width: 100%;" class="form-control" onchange="getData(this)"
                                        aria-describedby="floatingInput">
                                    <option value="1">Option 1</option>
                                    <option value="2">Option 2</option>
                                    <option value="3">Option 3</option>
                                    <option value="4">Option 4</option>
                                </select>
                            </div>
                        </div>


                        <div class="card-body">
                            <div class="form-floating">
                                <select id="mySelect" name="selectedOptions" multiple="multiple" style="width: 100%;" class="select2 form-select form-control"
                                        aria-describedby="floatingInput">
                                </select>
                            </div>
                        </div>


                    </div>
                </div>


                @* <div class="form-group">
                <label asp-for="Description" class="control-label"></label>
                <input asp-for="Description" class="form-control" />
                <span asp-validation-for="Description" class="text-danger"></span>
                </div>*@

                <div class="form-group">
                    <input type="submit" value="Create" class="btn btn-primary" />
                </div>
            </form>
        </div>
    </div>

    <div>
        <a asp-action="Index">Back to List</a>
    </div>
</div>


<!-- Include Select2 CSS -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

<!-- Include Select2 JS -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>



<script>

    $(document).ready(function () {
        $('#mySelect').select2({
            placeholder: 'Select options',
            allowClear: true
        });

        // Function to clear all selections
        $('#mySelectnone').on('onclick', function () {
            $('#mySelect').val(null).trigger('change');
        });

        $.validator.addMethod("DateTime", function (value, element) {
            var validDate = !/Invalid|NaN/.test(new Date(value).toString());
            console.log(validDate);
            return this.optional(element) || (validDate);
        }, "Please enter a valid date and time.");

        $("#Create").validate({
            rules: {
                time: {
                    required: true,
                    dateTime: true
                }
            },
            submitHandler: function (form) { // for demo
                alert('valid form'); // for demo
                return false;  // for demo
            }
        });



    });


    function ValidateDate() {
        var dateT = $('#DateTime').val();
        // var dateRegex = /^(?=\d)(?:(?:31(?!.(?:0?[2469]|11))|(?:30|29)(?!.0?2)|29(?=.0?2.(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))(?:\x20|$))|(?:2[0-8]|1\d|0?[1-9]))([-.\/])(?:1[012]|0?[1-9])\1(?:1[6-9]|[2-9]\d)?\d\d(?:(?=\x20\d)\x20|$))?(((0?[1-9]|1[012])(:[0-5]\d){0,2}(\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$/;
        // var slt = dateT.split('/');

        // if (slt.length >= 3 && slt[2].length != 4){
        //     alert("year is " + slt[2].length + " digit");
        //     return false;
        // }

        // return dateRegex.test(dateT);

        var regexDate = /^(0[1-9]|1[0-2])\/(0[1-9]|[1-2][0-9]|3[0-1])\/\d{4}$/;
        var slt = dateT.split('/');
        if (slt.length >= 3 && slt[2].length != 4) {
            $('#errorMessage').text("year is " + slt[2].length + " digit");
            return false;
        }
        return regexDate.test(dateT);

    }

    function getData(obj) {
        if (!ValidateDate())
            $('#errorMessage').text("date ios not correct");
        else
            $('#errorMessage').text("");

        var val = 1;
        debugger;
        $.ajax({
            url: "/Category/GetCountriesName?val=" + val,
            type: "GET",
            success: function (respone) {
                $('#mySelect').empty().trigger('change');
                $.each(respone, function (data, value) {
                    console.log(data);
                    console.log(value);
                    $("#mySelect").append($("<option></option>").val(value.value).html(value.text));
                })
            }
        });
    }



    flatpickr("#datetime-picker", {
        enableTime: true, // Enables time selection
        dateFormat: "Y-m-d H:i", // Date and time format
        minDate: "today", // Minimum selectable date
        maxDate: new Date().fp_incr(7), // Maximum selectable date (7 days from today)
        time_24hr: true, // Use a 24-hour time format
    });
</script>



